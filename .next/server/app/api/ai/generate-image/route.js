(()=>{var e={};e.id=5854,e.ids=[5854],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4936:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(79748),i=r(33873);let o=require("os"),s=async()=>{let e=o.homedir();for(let t of[i.join(process.cwd(),".z-ai-config"),i.join(e,".z-ai-config"),"/etc/.z-ai-config"])try{let e=await a.readFile(t,"utf-8"),r=JSON.parse(e);if(r.baseUrl&&r.apiKey)return r}catch(e){"ENOENT"!==e.code&&console.error(`Error reading or parsing config file at ${t}:`,e)}throw Error("Configuration file not found or invalid. Please create .z-ai-config in your project, home directory, or /etc.")};class n{constructor(e){this.config=e,this.chat={completions:{create:this.createChatCompletion.bind(this)}},this.images={generations:{create:this.createImageGeneration.bind(this)}},this.functions={invoke:this.invokeFunction.bind(this)}}static async create(){return new n(await s())}async createChatCompletion(e){let{baseUrl:t,chatId:r,userId:a,apiKey:i}=this.config,o=`${t}/chat/completions`,s={"Content-Type":"application/json",Authorization:`Bearer ${i}`,"X-Z-AI-From":"Z"};r&&(s["X-Chat-Id"]=r),a&&(s["X-User-Id"]=a);try{let t=await fetch(o,{method:"POST",headers:s,body:JSON.stringify(e)});if(!t.ok){let e=await t.text();throw Error(`API request failed with status ${t.status}: ${e}`)}return await t.json()}catch(e){throw console.error("Failed to make API request:",e),e}}async createImageGeneration(e){let{baseUrl:t,apiKey:r,chatId:a,userId:i}=this.config,o=`${t}/images/generations`,s={"Content-Type":"application/json",Authorization:`Bearer ${r}`,"X-Z-AI-From":"Z"};a&&(s["X-Chat-Id"]=a),i&&(s["X-User-Id"]=i);let n={...e};try{let e=await fetch(o,{method:"POST",headers:s,body:JSON.stringify(n)});if(!e.ok){let t=await e.text();throw Error(`API request failed with status ${e.status}: ${t}`)}let t=await e.json(),r=await Promise.all(t.data.map(async e=>e.url?{base64:await this.downloadImageAsBase64(e.url),format:"png"}:e));return{...t,data:r}}catch(e){throw console.error("Failed to make image generation request:",e),e}}async downloadImageAsBase64(e){try{let t=await fetch(e);if(!t.ok)throw Error(`Failed to download image: ${t.status}`);let r=await t.arrayBuffer(),a=Buffer.from(r).toString("base64");return`${a}`}catch(e){throw console.error("Failed to download and convert image to base64:",e),e}}async invokeFunction(e,t){let{baseUrl:r,apiKey:a,chatId:i,userId:o}=this.config,s=`${r}/functions/invoke`,n={"Content-Type":"application/json",Authorization:`Bearer ${a}`,"X-Z-AI-From":"Z"};i&&(n["X-Chat-Id"]=i),o&&(n["X-User-Id"]=o);try{let r=await fetch(s,{method:"POST",headers:n,body:JSON.stringify({function_name:e,arguments:t})});if(!r.ok){let e=await r.text();throw Error(`Function invoke failed with status ${r.status}: ${e}`)}return(await r.json()).result}catch(e){throw console.error("Failed to invoke remote function:",e),e}}}let c=n},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},72161:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>u,serverHooks:()=>h,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>p});var a={};r.r(a),r.d(a,{POST:()=>l});var i=r(96559),o=r(48088),s=r(37719),n=r(32190),c=r(4936);async function l(e){try{let{prompt:t,productName:r,category:a,style:i,size:o="1024x1024"}=await e.json();if(!t&&!r)return n.NextResponse.json({error:"Prompt or product name is required"},{status:400});let s=await c.A.create(),l=t;if(!l&&r){let e=a?` ${a}`:"";l=`Professional product photography of ${r}${e}, clean white background, studio lighting, high quality, commercial product shot, e-commerce style`}let u={realistic:"photorealistic, high detail, professional photography",minimalist:"minimalist, clean, simple background, white space",lifestyle:"lifestyle photography, natural setting, real-world usage",studio:"studio photography, professional lighting, seamless background",creative:"creative, artistic, unique perspective, eye-catching"};i&&u[i]&&(l+=`, ${u[i]}`),l+=", 4k, ultra detailed, sharp focus, professional lighting",console.log("Generating image with prompt:",l);let d=await s.images.generations.create({prompt:l,size:o});if(!d.data||0===d.data.length)throw Error("No image generated");let p=d.data[0].base64;if(!p)throw Error("No image data received");let h=`data:image/png;base64,${p}`;return n.NextResponse.json({success:!0,imageUrl:h,prompt:l,size:o})}catch(e){return console.error("Error generating image:",e),n.NextResponse.json({error:"Failed to generate image",details:e.message},{status:500})}}let u=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/ai/generate-image/route",pathname:"/api/ai/generate-image",filename:"route",bundlePath:"app/api/ai/generate-image/route"},resolvedPagePath:"/home/runner/work/sellor-ai-ecommerce/sellor-ai-ecommerce/src/app/api/ai/generate-image/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:d,workUnitAsyncStorage:p,serverHooks:h}=u;function g(){return(0,s.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:p})}},78335:()=>{},79748:e=>{"use strict";e.exports=require("fs/promises")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[4447,580],()=>r(72161));module.exports=a})();